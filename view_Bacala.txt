
--d) Top-Content: For each month, display the content involving more income.
--e) BacalÃ¡: top 5 movies dropped (stop viewing) after visualizing more than half of its duration (viewing
--97% or more is taken as complete visualization).

CREATE VIEW Bacala AS
SELECT title, pct
FROM taps_movies
WHERE (pct > 50) AND (pct < 97)
GROUP BY title, pct;

CREATE VIEW final AS
SELECT title, COUNT(pct) AS num
FROM Bacala
GROUP BY title, num
ORDER BY num DESC;


CREATE VIEW finaldos AS
SELECT title
FROM final
WHERE ROWNUM <= 5;


CREATE VIEW Bacala AS
SELECT title
FROM(SELECT title, COUNT(pct) AS num
FROM (SELECT title, pct
FROM taps_movies
WHERE (pct > 50) AND (pct < 97)
GROUP BY title, pct)
GROUP BY title, num
ORDER BY num DESC)
WHERE ROWNUM <= 5;
