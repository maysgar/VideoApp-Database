--c) Clients who have bought license for a complete season of any TVseries (include the title and season). 

CREATE VIEW primera AS
SELECT client, title AS title1, season AS season1, COUNT(datetime) AS n_episodes
FROM lic_series
GROUP BY client, title, season;

CREATE VIEW comparar AS
SELECT client, title1, season1, n_episodes
FROM primera
JOIN seasons ON (PRIMERA.title1 = SEASONS.title) AND (PRIMERA.season1 = SEASONS.season) AND (PRIMERA.n_episodes = SEASONS.episodes)
GROUP BY client, title1, season1, n_episodes;

CREATE VIEW terminar AS 
SELECT client, title1, season1
FROM comparar;



SELECT client, title1, season1
FROM (SELECT client, title1, season1, n_episodes
		    FROM (SELECT client, title AS title1, season AS season1, COUNT(datetime) AS n_episodes
					   FROM lic_series
					   GROUP BY client, title, season;)
			JOIN seasons ON (LIC_SERIES.title1 = SEASONS.title) AND (LIC_SERIES.season1 = SEASONS.season) AND (LIC_SERIES.n_episodes = SEASONS.episodes)
            GROUP BY client, title1, season1, n_episodes);
