CREATE VIEW pidgeonholed AS
SELECT actor, genre, maximo
FROM(SELECT MAX(num) as maximo, actor, genre
FROM (SELECT genre, actor, COUNT(title1) as num
FROM (SELECT  genre, actor, title as title1
FROM casts
NATURAL JOIN genres_movies)
GROUP BY genre, actor HAVING COUNT(title1)>=3)
GROUP BY actor, genre)
ORDER BY maximo DESC;
